<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rock Types Analysis</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #8B1538 0%, #5D5D5D 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #8B1538, #5D5D5D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1em;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        
        .dropdown-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1em;
        }
        
        select {
            padding: 12px 20px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            color: #2c3e50;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }
        
        select:focus {
            outline: none;
            border-color: #8B1538;
            box-shadow: 0 0 0 3px rgba(139, 21, 56, 0.1);
        }
        
        select:hover {
            border-color: #8B1538;
        }
        
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            position: relative;
            overflow: hidden;
        }
        
        .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #8B1538, #5D5D5D);
        }
        
        .chart-wrapper {
            position: relative;
            height: 500px;
            margin-top: 20px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #8B1538, #5D5D5D);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            min-width: 150px;
            box-shadow: 0 5px 15px rgba(139, 21, 56, 0.3);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Facies Classification</h1>
            <p class="subtitle">-- Welcome! This webapp uses chart.js to showcase --</p>
            <p class="subtitle">-- the data I worked with while creating, deploying, and monitoring classification ML models --</p>
        </div>
        
        <div class="controls">
            <div class="dropdown-container">
                <label for="chartType">Total Count:</label>
                <select id="chartType">
                    <option value="doughnut">Doughnut Chart</option>
                    <option value="sunburst">Sunburst Chart</option>
                </select>
            </div>
            <div class="dropdown-container">
                <label for="rockTypeFilter">Marine vs. Nonmarine:</label>
                <select id="rockTypeFilter">
                    <option value="all">All Types</option>
                    <option value="Nonmarine coarse siltstone">Nonmarine coarse siltstone</option>
                    <option value="Nonmarine fine siltstone">Nonmarine fine siltstone</option>
                    <option value="Packstone-grainstone">Packstone-grainstone</option>
                    <option value="Wackestone">Wackestone</option>
                    <option value="Mudstone">Mudstone</option>
                    <option value="Marine siltstone and shale">Marine siltstone and shale</option>
                    <option value="Nonmarine sandstone">Nonmarine sandstone</option>
                    <option value="Phylloid-algal bafflestone">Phylloid-algal bafflestone</option>
                    <option value="Dolomite">Dolomite</option>
                </select>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalRocks">-</div>
                <div class="stat-label">Total Samples</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="uniqueTypes">-</div>
                <div class="stat-label">Rock Types</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="mostCommon">-</div>
                <div class="stat-label">Most Common</div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-wrapper">
                <canvas id="rockChart"></canvas>
            </div>
        </div>
    </div>
    <script>
        let faciesTypes = [
            'Nonmarine coarse siltstone',
            'Nonmarine fine siltstone', 
            'Packstone-grainstone',
            'Wackestone',
            'Mudstone',
            'Marine siltstone and shale',
            'Nonmarine sandstone',
            'Phylloid-algal bafflestone',
            'Dolomite'
        ];
        let faciesCounts = {
            'Nonmarine coarse siltstone': 940,
            'Nonmarine fine siltstone': 780,
            'Packstone-grainstone': 686,
            'Wackestone': 582,
            'Mudstone': 296,
            'Marine siltstone and shale': 271,
            'Nonmarine sandstone': 268,
            'Phylloid-algal bafflestone': 185,
            'Dolomite': 141
        };
        let rockSamples = [];
        let chart = null;
        let currentFilter = 'all';
        
        function generateSampleData() {
            rockSamples = [];
            let id = 1;
            
            faciesTypes.forEach((type) => {
                const count = faciesCounts[type];
                for (let i = 0; i < count; i++) {
                    rockSamples.push({
                        id: id++,
                        name: `${type} Sample ${i + 1}`,
                        type: type
                    });
                }
            });
        }
        
        function updateStats() {
            const filteredData = getFilteredData();
            const typeCounts = {};
            
            filteredData.forEach(sample => {
                typeCounts[sample.type] = (typeCounts[sample.type] || 0) + 1;
            });
            
            const mostCommonType = Object.entries(typeCounts).reduce((a, b) => 
                typeCounts[a[0]] > typeCounts[b[0]] ? a : b, ['', 0])[0];
            
            document.getElementById('totalRocks').textContent = filteredData.length;
            document.getElementById('uniqueTypes').textContent = Object.keys(typeCounts).length;
            document.getElementById('mostCommon').textContent = mostCommonType || '-';
        }
        
        function getFilteredData() {
            if (currentFilter === 'all') {
                return rockSamples;
            }
            return rockSamples.filter(sample => sample.type === currentFilter);
        }
        
        function createChart() {
            const ctx = document.getElementById('rockChart').getContext('2d');
            const filteredData = getFilteredData();
            const chartType = document.getElementById('chartType').value;
            
            const typeCounts = {};
            filteredData.forEach(sample => {
                typeCounts[sample.type] = (typeCounts[sample.type] || 0) + 1;
            });
            
            if (chart) {
                chart.destroy();
            }
            
            if (chartType === 'sunburst') {
                createSunburstChart(ctx, typeCounts);
            } else {
                createDoughnutChart(ctx, typeCounts);
            }
        }
        
        function createDoughnutChart(ctx, typeCounts) {
            const labels = Object.keys(typeCounts);
            const data = Object.values(typeCounts);
            const colors = [
                '#8B1538', '#A0522D', '#5D5D5D', '#800020', '#708090',
                '#B8860B', '#696969', '#8B0000', '#2F4F4F'
            ];
            
            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Rock Type Count',
                        data: data,
                        backgroundColor: colors,
                        borderColor: colors.map(color => color + '80'),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            cornerRadius: 8,
                            displayColors: true
                        }
                    },
                    animation: {
                        animateRotate: true,
                        animateScale: true
                    }
                }
            });
        }
        
        function createSunburstChart(ctx, typeCounts) {
            // cat into marine/nonmarine
            const marineTypes = {};
            const nonmarineTypes = {};
            
            Object.entries(typeCounts).forEach(([type, count]) => {
                if (type.toLowerCase().includes('marine') && !type.toLowerCase().includes('nonmarine')) {
                    marineTypes[type] = count;
                } else if (type.toLowerCase().includes('nonmarine')) {
                    nonmarineTypes[type] = count;
                } else {
                    // vague/not mentioned? cat based on rock type
                    if (type.includes('Packstone') || type.includes('Wackestone') || 
                        type.includes('Mudstone') || type.includes('Dolomite') || 
                        type.includes('bafflestone')) {
                        marineTypes[type] = count;
                    } else {
                        nonmarineTypes[type] = count;
                    }
                }
            });
            
            // outer ring data -- specs
            const outerLabels = [];
            const outerData = [];
            const outerColors = [];
            
            // inner ring data -- mar/nonmar
            const innerData = [];
            const innerLabels = [];
            const innerColors = [];
            
            // marine
            Object.entries(marineTypes).forEach(([type, count]) => {
                outerLabels.push(type);
                outerData.push(count);
                outerColors.push('#3b82f6');
                
                // ~ inner ring segment
                innerData.push(count);
                innerLabels.push('Marine');
                innerColors.push('#1e40af');
            });
            
            // nonmarine
            Object.entries(nonmarineTypes).forEach(([type, count]) => {
                outerLabels.push(type);
                outerData.push(count);
                outerColors.push('#ef4444');
                
                // ~ inner ring segment
                innerData.push(count);
                innerLabels.push('Nonmarine');
                innerColors.push('#dc2626');
            });
            
            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        label: 'Environment',
                        data: innerData,
                        backgroundColor: innerColors,
                        borderWidth: 2,
                        borderColor: '#fff',
                        radius: '60%',
                        cutout: '30%'
                    }, {
                        label: 'Facies Type',
                        data: outerData,
                        backgroundColor: outerColors,
                        borderWidth: 2,
                        borderColor: '#fff',
                        radius: '80%',
                        cutout: '60%'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                usePointStyle: true,
                                font: {
                                    size: 11
                                },
                                generateLabels: function(chart) {
                                    const outerDataset = chart.data.datasets[1];
                                    return outerDataset.data.map((data, index) => ({
                                        text: `${outerLabels[index]} (${data})`,
                                        fillStyle: outerDataset.backgroundColor[index],
                                        strokeStyle: outerDataset.backgroundColor[index],
                                        lineWidth: 0,
                                        pointStyle: 'circle'
                                    }));
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            cornerRadius: 8,
                            callbacks: {
                                title: function(context) {
                                    if (context[0].datasetIndex === 0) {
                                        return context[0].label + ' Environment';
                                    } else {
                                        return context[0].label;
                                    }
                                },
                                label: function(context) {
                                    const value = context.parsed;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `Count: ${value} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    animation: {
                        animateRotate: true,
                        animateScale: true
                    }
                }
            });
        }
        
        function handleFilterChange() {
            currentFilter = document.getElementById('rockTypeFilter').value;
            updateStats();
            createChart();
        }
        
        function handleChartTypeChange() {
            createChart();
        }
        
        function init() {
            generateSampleData();
            document.getElementById('rockTypeFilter').addEventListener('change', handleFilterChange);
            document.getElementById('chartType').addEventListener('change', handleChartTypeChange);
            updateStats();
            createChart();
        }
        
        window.addEventListener('load', init);

    </script>
    <p style = "text-align: center;" class="text"><br>Special thanks to Brad Martin and SLB for this opportunity<br>and help along the way.</p>
</body>
</html>
